<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RaftLib: simple_schedule Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RaftLib
   &#160;<span id="projectnumber">0.9a</span>
   </div>
   <div id="projectbrief">C++ Stream Processing Template Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classsimple__schedule-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">simple_schedule Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for simple_schedule:</div>
<div class="dyncontent">
<div class="center"><img src="classsimple__schedule__inherit__graph.png" border="0" usemap="#simple__schedule_inherit__map" alt="Inheritance graph"/></div>
<map name="simple__schedule_inherit__map" id="simple__schedule_inherit__map">
<area shape="rect" id="node2" href="class_schedule.html" title="Schedule" alt="" coords="27,5,104,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for simple_schedule:</div>
<div class="dyncontent">
<div class="center"><img src="classsimple__schedule__coll__graph.png" border="0" usemap="#simple__schedule_coll__map" alt="Collaboration graph"/></div>
<map name="simple__schedule_coll__map" id="simple__schedule_coll__map">
<area shape="rect" id="node2" href="class_schedule.html" title="Schedule" alt="" coords="100,125,177,151"/>
<area shape="rect" id="node4" href="class_system_signal_handler.html" title="SystemSignalHandler" alt="" coords="141,5,290,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsimple__schedule_1_1thread__data.html">thread_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsimple__schedule_1_1thread__info__t.html">thread_info_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af67989b8a100e97f549e3dee6847a35c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimple__schedule.html#af67989b8a100e97f549e3dee6847a35c">simple_schedule</a> (<a class="el" href="classraft_1_1map.html">raft::map</a> &amp;map)</td></tr>
<tr class="separator:af67989b8a100e97f549e3dee6847a35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60a7608111e011d0c04f6ac566cfd8c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimple__schedule.html#ad60a7608111e011d0c04f6ac566cfd8c">start</a> ()</td></tr>
<tr class="separator:ad60a7608111e011d0c04f6ac566cfd8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_schedule"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_schedule')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_schedule.html">Schedule</a></td></tr>
<tr class="memitem:ae3fcf18fa8bdbe2ac438962a324cf433 inherit pub_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#ae3fcf18fa8bdbe2ac438962a324cf433">Schedule</a> (<a class="el" href="classraft_1_1map.html">raft::map</a> &amp;map)</td></tr>
<tr class="separator:ae3fcf18fa8bdbe2ac438962a324cf433 inherit pub_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e52c571576866ef55cb4e891232c58 inherit pub_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a68e52c571576866ef55cb4e891232c58">~Schedule</a> ()=default</td></tr>
<tr class="separator:a68e52c571576866ef55cb4e891232c58 inherit pub_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5180032a0c2135507859ccf2a4eea1ab inherit pub_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a5180032a0c2135507859ccf2a4eea1ab">init</a> ()</td></tr>
<tr class="separator:a5180032a0c2135507859ccf2a4eea1ab inherit pub_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a722f6e76c8b8dc67874d9974b6d641 inherit pub_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a6a722f6e76c8b8dc67874d9974b6d641">scheduleKernel</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const kernel)</td></tr>
<tr class="separator:a6a722f6e76c8b8dc67874d9974b6d641 inherit pub_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aafebb0cc13b4539387790ff54ea40830"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimple__schedule.html#aafebb0cc13b4539387790ff54ea40830">handleSchedule</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const kernel)</td></tr>
<tr class="separator:aafebb0cc13b4539387790ff54ea40830"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a128caa6bacc62c7289bb09f234ef75b7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimple__schedule.html#a128caa6bacc62c7289bb09f234ef75b7">simple_run</a> (void *data)</td></tr>
<tr class="separator:a128caa6bacc62c7289bb09f234ef75b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_class_schedule"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_class_schedule')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="class_schedule.html">Schedule</a></td></tr>
<tr class="memitem:a85de3d48407aa378ccc86a4a4206b32a inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static raft::kstatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a85de3d48407aa378ccc86a4a4206b32a">checkSystemSignal</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const kernel, void *data, <a class="el" href="class_system_signal_handler.html">SystemSignalHandler</a> &amp;<a class="el" href="class_schedule.html#ad248e99611a87776fb411836cd46a603">handlers</a>)</td></tr>
<tr class="separator:a85de3d48407aa378ccc86a4a4206b32a inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5167d622689a34ea5f3a065304295521 inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static raft::kstatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a5167d622689a34ea5f3a065304295521">quitHandler</a> (<a class="el" href="class_f_i_f_o.html">FIFO</a> &amp;fifo, <a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *kernel, const raft::signal signal, void *data)</td></tr>
<tr class="separator:a5167d622689a34ea5f3a065304295521 inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf10fd9419c58849d7be98336dc0aff inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top"><a id="a3bf10fd9419c58849d7be98336dc0aff"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>invalidateOutputPorts</b> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *kernel)</td></tr>
<tr class="separator:a3bf10fd9419c58849d7be98336dc0aff inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23de3dd63554401fd0d8d23b60eecfa inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#ac23de3dd63554401fd0d8d23b60eecfa">kernelHasInputData</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *kernel)</td></tr>
<tr class="separator:ac23de3dd63554401fd0d8d23b60eecfa inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2035e0c0666054f8401ad2b3792854 inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a2e2035e0c0666054f8401ad2b3792854">kernelHasNoInputPorts</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *kernel)</td></tr>
<tr class="separator:a2e2035e0c0666054f8401ad2b3792854 inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefaf185cc7d1f424cef7b23d8f679d47 inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#aefaf185cc7d1f424cef7b23d8f679d47">setPtrSets</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const kernel, ptr_map_t *const in, ptr_set_t *const out, ptr_set_t *const peekset)</td></tr>
<tr class="separator:aefaf185cc7d1f424cef7b23d8f679d47 inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64d4c026c95da079a92d2a3790bb5279 inherit pro_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top"><a id="a64d4c026c95da079a92d2a3790bb5279"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>fifo_gc</b> (ptr_map_t *const in, ptr_set_t *const out, ptr_set_t *const peekset)</td></tr>
<tr class="separator:a64d4c026c95da079a92d2a3790bb5279 inherit pro_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a2f47cf02f323a32405d17e27746c515d"><td class="memItemLeft" align="right" valign="top"><a id="a2f47cf02f323a32405d17e27746c515d"></a>
std::mutex&#160;</td><td class="memItemRight" valign="bottom"><b>thread_map_mutex</b></td></tr>
<tr class="separator:a2f47cf02f323a32405d17e27746c515d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6f1b93365dc324a72c467765ffef86"><td class="memItemLeft" align="right" valign="top"><a id="a1c6f1b93365dc324a72c467765ffef86"></a>
std::vector&lt; <a class="el" href="structsimple__schedule_1_1thread__info__t.html">thread_info_t</a> *&gt;&#160;</td><td class="memItemRight" valign="bottom"><b>thread_map</b></td></tr>
<tr class="separator:a1c6f1b93365dc324a72c467765ffef86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_schedule"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_schedule')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_schedule.html">Schedule</a></td></tr>
<tr class="memitem:ad248e99611a87776fb411836cd46a603 inherit pro_attribs_class_schedule"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_system_signal_handler.html">SystemSignalHandler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#ad248e99611a87776fb411836cd46a603">handlers</a></td></tr>
<tr class="separator:ad248e99611a87776fb411836cd46a603 inherit pro_attribs_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a448b0d48e656f94db65a70cedd8eed inherit pro_attribs_class_schedule"><td class="memItemLeft" align="right" valign="top">kernelkeeper &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#a1a448b0d48e656f94db65a70cedd8eed">kernel_set</a></td></tr>
<tr class="separator:a1a448b0d48e656f94db65a70cedd8eed inherit pro_attribs_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c895eb77d8287a9a19215cced7af7b inherit pro_attribs_class_schedule"><td class="memItemLeft" align="right" valign="top"><a id="ad4c895eb77d8287a9a19215cced7af7b"></a>
kernelkeeper &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>source_kernels</b></td></tr>
<tr class="separator:ad4c895eb77d8287a9a19215cced7af7b inherit pro_attribs_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf2c26334eae760032d82a016898043 inherit pro_attribs_class_schedule"><td class="memItemLeft" align="right" valign="top"><a id="aebf2c26334eae760032d82a016898043"></a>
kernelkeeper &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>dst_kernels</b></td></tr>
<tr class="separator:aebf2c26334eae760032d82a016898043 inherit pro_attribs_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_class_schedule"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_class_schedule')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="class_schedule.html">Schedule</a></td></tr>
<tr class="memitem:acf28b4a4231e693585751a035873615c inherit pub_static_methods_class_schedule"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_schedule.html#acf28b4a4231e693585751a035873615c">kernelRun</a> (<a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const kernel, volatile bool &amp;finished, jmp_buf *gotostate=nullptr, jmp_buf *kernel_state=nullptr)</td></tr>
<tr class="separator:acf28b4a4231e693585751a035873615c inherit pub_static_methods_class_schedule"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="simpleschedule_8hpp_source.html#l00032">32</a> of file <a class="el" href="simpleschedule_8hpp_source.html">simpleschedule.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af67989b8a100e97f549e3dee6847a35c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af67989b8a100e97f549e3dee6847a35c">&sect;&nbsp;</a></span>simple_schedule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simple_schedule::simple_schedule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classraft_1_1map.html">raft::map</a> &amp;&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a> - </p><dl class="section author"><dt>Author</dt><dd>: Jonathan Beard </dd></dl>
<dl class="section version"><dt>Version</dt><dd>: Thu Sep 11 15:49:57 2014</dd></dl>
<p>Copyright 2014 Jonathan Beard</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at:</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>

<p>Definition at line <a class="el" href="simpleschedule_8cpp_source.html#l00047">47</a> of file <a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                               : <a class="code" href="class_schedule.html#ae3fcf18fa8bdbe2ac438962a324cf433">Schedule</a>( map )</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div><div class="ttc" id="class_schedule_html_ae3fcf18fa8bdbe2ac438962a324cf433"><div class="ttname"><a href="class_schedule.html#ae3fcf18fa8bdbe2ac438962a324cf433">Schedule::Schedule</a></div><div class="ttdeci">Schedule(raft::map &amp;map)</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8cpp_source.html#l00010">schedule.cpp:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aafebb0cc13b4539387790ff54ea40830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafebb0cc13b4539387790ff54ea40830">&sect;&nbsp;</a></span>handleSchedule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simple_schedule::handleSchedule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classraft_1_1kernel.html">raft::kernel</a> *const&#160;</td>
          <td class="paramname"><em>kernel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>TODO: lets add the affinity dynamically here</p>
<p>thread function takes a reference back to the scheduler accessible done boolean flag, essentially when the kernel is done, it can be rescheduled...and this handles that.</p>
<p>we got here, unlock </p>

<p>Implements <a class="el" href="class_schedule.html">Schedule</a>.</p>

<p>Definition at line <a class="el" href="simpleschedule_8cpp_source.html#l00122">122</a> of file <a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">      /** </span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">       * TODO: lets add the affinity dynamically here</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keyword">auto</span> * <span class="keyword">const</span> th_info( <span class="keyword">new</span> thread_info_t( kernel ) );<span class="comment"></span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">      /** </span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">       * thread function takes a reference back to the scheduler</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">       * accessible done boolean flag, essentially when the </span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">       * kernel is done, it can be rescheduled...and this</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">       * handles that.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">while</span>( ! thread_map_mutex.try_lock() )</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         std::this_thread::yield();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      thread_map.emplace_back( th_info );<span class="comment"></span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      /** we got here, unlock **/</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      thread_map_mutex.unlock();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a128caa6bacc62c7289bb09f234ef75b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a128caa6bacc62c7289bb09f234ef75b7">&sect;&nbsp;</a></span>simple_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simple_schedule::simple_run </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>call does nothing if not available </p>

<p>Definition at line <a class="el" href="simpleschedule_8cpp_source.html#l00145">145</a> of file <a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a>.</p>

<p>References <a class="el" href="schedule_8cpp_source.html#l00158">Schedule::kernelRun()</a>, <a class="el" href="affinity_8cpp_source.html#l00043">affinity::set()</a>, and <a class="el" href="schedule_8cpp_source.html#l00187">Schedule::setPtrSets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   assert( data != <span class="keyword">nullptr</span> );</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keyword">auto</span> * <span class="keyword">const</span> thread_d( reinterpret_cast&lt; thread_data* &gt;( data ) );</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   ptr_map_t in;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   ptr_set_t out;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   ptr_set_t peekset;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="class_schedule.html#aefaf185cc7d1f424cef7b23d8f679d47">Schedule::setPtrSets</a>( thread_d-&gt;k, </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        &amp;in, </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                        &amp;out,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        &amp;peekset );</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">if</span>( thread_d-&gt;loc != -1 )</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   {<span class="comment"></span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">      /** call does nothing if not available **/</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="structaffinity.html#abe34f20b4d661e9ed44ca5def0470e00">affinity::set</a>( thread_d-&gt;loc );</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#ifdef USE_PARTITION</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       assert( <span class="keyword">false</span> );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">while</span>( ! *(thread_d-&gt;finished) )</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="class_schedule.html#acf28b4a4231e693585751a035873615c">Schedule::kernelRun</a>( thread_d-&gt;k, *(thread_d-&gt;finished) );</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="comment">//takes care of peekset clearing too</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      Schedule::fifo_gc( &amp;in, &amp;out, &amp;peekset );</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div><div class="ttc" id="class_schedule_html_acf28b4a4231e693585751a035873615c"><div class="ttname"><a href="class_schedule.html#acf28b4a4231e693585751a035873615c">Schedule::kernelRun</a></div><div class="ttdeci">static bool kernelRun(raft::kernel *const kernel, volatile bool &amp;finished, jmp_buf *gotostate=nullptr, jmp_buf *kernel_state=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8cpp_source.html#l00158">schedule.cpp:158</a></div></div>
<div class="ttc" id="class_schedule_html_aefaf185cc7d1f424cef7b23d8f679d47"><div class="ttname"><a href="class_schedule.html#aefaf185cc7d1f424cef7b23d8f679d47">Schedule::setPtrSets</a></div><div class="ttdeci">static void setPtrSets(raft::kernel *const kernel, ptr_map_t *const in, ptr_set_t *const out, ptr_set_t *const peekset)</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8cpp_source.html#l00187">schedule.cpp:187</a></div></div>
<div class="ttc" id="structaffinity_html_abe34f20b4d661e9ed44ca5def0470e00"><div class="ttname"><a href="structaffinity.html#abe34f20b4d661e9ed44ca5def0470e00">affinity::set</a></div><div class="ttdeci">static void set(const std::size_t desired_core)</div><div class="ttdef"><b>Definition:</b> <a href="affinity_8cpp_source.html#l00043">affinity.cpp:43</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classsimple__schedule_a128caa6bacc62c7289bb09f234ef75b7_cgraph.png" border="0" usemap="#classsimple__schedule_a128caa6bacc62c7289bb09f234ef75b7_cgraph" alt=""/></div>
<map name="classsimple__schedule_a128caa6bacc62c7289bb09f234ef75b7_cgraph" id="classsimple__schedule_a128caa6bacc62c7289bb09f234ef75b7_cgraph">
<area shape="rect" id="node2" href="class_schedule.html#acf28b4a4231e693585751a035873615c" title="Schedule::kernelRun" alt="" coords="247,61,392,87"/>
<area shape="rect" id="node6" href="structaffinity.html#abe34f20b4d661e9ed44ca5def0470e00" title="affinity::set" alt="" coords="277,111,362,136"/>
<area shape="rect" id="node7" href="class_schedule.html#aefaf185cc7d1f424cef7b23d8f679d47" title="Schedule::setPtrSets" alt="" coords="247,160,392,185"/>
<area shape="rect" id="node3" href="class_schedule.html#ac23de3dd63554401fd0d8d23b60eecfa" title="Schedule::kernelHasInputData" alt="" coords="440,5,643,31"/>
<area shape="rect" id="node4" href="class_schedule.html#a2e2035e0c0666054f8401ad2b3792854" title="Schedule::kernelHasNoInput\lPorts" alt="" coords="446,55,637,93"/>
<area shape="rect" id="node5" href="classraft_1_1kernel.html#a05094286d7577360fb1b91c91fc05901" title="raft::kernel::run" alt="" coords="486,117,597,143"/>
</map>
</div>

</div>
</div>
<a id="ad60a7608111e011d0c04f6ac566cfd8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60a7608111e011d0c04f6ac566cfd8c">&sect;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simple_schedule::start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>start - called to start execution of all kernels. Implementation specific so it is purely virtual. </p>
<p>NOTE: this section is the same as the code in the "handleSchedule" function so that it doesn't call the lock for the thread map.</p>
<p>FIXME: the list could get huge for long running apps, need to delete these entries...especially since we have a lock on the list now</p>
<p>NOTE: added to keep from having to unlock these so frequently might need to make the interval adjustable dep. on app</p>

<p>Implements <a class="el" href="class_schedule.html#ab6ad5540ecdef6b472b4e8242a47c4ee">Schedule</a>.</p>

<p>Definition at line <a class="el" href="simpleschedule_8cpp_source.html#l00064">64</a> of file <a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a>.</p>

<p>References <a class="el" href="schedule_8hpp_source.html#l00182">Schedule::kernel_set</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">   /** </span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    * NOTE: this section is the same as the code in the &quot;handleSchedule&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    * function so that it doesn&#39;t call the lock for the thread map.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="keyword">auto</span> &amp;container( <a class="code" href="class_schedule.html#a1a448b0d48e656f94db65a70cedd8eed">kernel_set</a>.acquire() );</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">for</span>( <span class="keyword">auto</span> * <span class="keyword">const</span> k : container )</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   {  </div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keyword">auto</span> * <span class="keyword">const</span> th_info( <span class="keyword">new</span> thread_info_t( k ) );</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      th_info-&gt;data.loc = k-&gt;getCoreAssignment();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      thread_map.emplace_back( th_info );</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <a class="code" href="class_schedule.html#a1a448b0d48e656f94db65a70cedd8eed">kernel_set</a>.release();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keywordtype">bool</span> keep_going( <span class="keyword">true</span> );</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="keywordflow">while</span>( keep_going )</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">while</span>( ! thread_map_mutex.try_lock() )</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         std::this_thread::yield();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }     </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">//exit, we have a lock</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      keep_going = <span class="keyword">false</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">auto</span>  *t_info : thread_map )</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         <span class="keywordflow">if</span>( ! t_info-&gt;term )</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="comment">//loop over each thread and check if done</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">if</span>( t_info-&gt;finished )</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            {<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">               /**</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">                * FIXME: the list could get huge for long running apps,</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">                * need to delete these entries...especially since we have</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">                * a lock on the list now </span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;               t_info-&gt;th.join();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;               t_info-&gt;term = <span class="keyword">true</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">else</span> <span class="comment">/* a kernel ! finished */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;               keep_going =  <span class="keyword">true</span>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">//if we&#39;re here we have a lock and need to unlock</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      thread_map_mutex.unlock();<span class="comment"></span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">      /**</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">       * NOTE: added to keep from having to unlock these so frequently</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">       * might need to make the interval adjustable dep. on app</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      std::chrono::milliseconds dura( 3 );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      std::this_thread::sleep_for( dura );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="ttc" id="class_schedule_html_a1a448b0d48e656f94db65a70cedd8eed"><div class="ttname"><a href="class_schedule.html#a1a448b0d48e656f94db65a70cedd8eed">Schedule::kernel_set</a></div><div class="ttdeci">kernelkeeper &amp; kernel_set</div><div class="ttdef"><b>Definition:</b> <a href="schedule_8hpp_source.html#l00182">schedule.hpp:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="simpleschedule_8hpp_source.html">simpleschedule.hpp</a></li>
<li><a class="el" href="simpleschedule_8cpp_source.html">simpleschedule.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 5 2016 12:42:39 for RaftLib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
